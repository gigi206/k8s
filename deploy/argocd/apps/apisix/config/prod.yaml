---
environment: prod
appName: apisix

apisix:
  namespace: apisix
  chart:
    repo: https://charts.apiseven.com
    name: apisix
    version: "2.12.5"

  # APISIX Configuration
  gateway:
    type: LoadBalancer
    http:
      enabled: true
    tls:
      enabled: true

  admin:
    enabled: true
    type: ClusterIP
    credentials:
      admin: CHANGE_ME_IN_PRODUCTION
      viewer: CHANGE_ME_IN_PRODUCTION

  # Enable Prometheus metrics
  serviceMonitor:
    enabled: true
    interval: 30s

  # Resource limits for production
  replicaCount: 3
  resources:
    limits:
      cpu: "2000m"
      memory: "2Gi"
    requests:
      cpu: "500m"
      memory: "512Mi"

  # ETCD configuration (HA setup)
  etcd:
    enabled: true
    replicaCount: 3
    persistence:
      enabled: true
      size: "10Gi"

# Gateway API resources (GatewayClass, Gateway, Certificate)
gatewayAPI:
  enabled: true  # Deploy GatewayClass and default-gateway

# APISIX Dashboard configuration
dashboard:
  enabled: true
  chart:
    repo: https://charts.apiseven.com
    name: apisix-dashboard
    version: "0.8.3"
  replicaCount: 2
  service:
    type: ClusterIP
    port: 80
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "1000m"
      memory: "512Mi"
  config:
    listen:
      host: "0.0.0.0"
      port: 9000

# APISIX Ingress Controller (sub-chart, for Gateway API support)
ingressController:
  enabled: true
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "1000m"
      memory: "512Mi"

# Sync policy (manual for production)
syncPolicy:
  automated:
    enabled: false
  syncOptions:
    - CreateNamespace=true
    - ServerSideApply=true
  retry:
    limit: 10
    backoff:
      duration: "10s"
      factor: 2
      maxDuration: "10m"
