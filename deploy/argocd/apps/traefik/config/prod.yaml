---
# Configuration Traefik - Prod
environment: prod
appName: traefik

# Dashboard configuration
dashboard:
  folder: "Traefik"  # Sous-dossier pour les dashboards Traefik

traefik:
  version: "38.0.2"
  deployment:
    # Kind: Deployment or DaemonSet
    kind: "Deployment"
    # Replicas (prod: 3 for HA)
    replicas: 3

  # Service configuration
  service:
    type: "LoadBalancer"

  # IngressClass configuration
  ingressClass:
    enabled: true
    isDefaultClass: false  # nginx-ingress or istio is default

  # Gateway API - GatewayClass
  gatewayClass:
    enabled: true
    name: "traefik"

  # Resources (prod: higher limits)
  resources:
    requests:
      cpu: "200m"
      memory: "256Mi"
    limits:
      cpu: "1000m"
      memory: "512Mi"

  # Entrypoints
  ports:
    web:
      port: 8000
      exposedPort: 80
    websecure:
      port: 8443
      exposedPort: 443

  # Dashboard (prod: disabled for security)
  dashboard:
    enabled: false

  # Logs (prod: access logs enabled for troubleshooting)
  logs:
    level: "WARN"
    accessLogs: true

  # High availability (prod only)
  ha:
    hpa:
      enabled: true
    pdb:
      enabled: true

  # Security middlewares (prod: enabled)
  security:
    enabled: true

syncPolicy:
  automated:
    enabled: false  # Prod: manual sync
    prune: true
    selfHeal: true
  # ServerSideApply=true allows shared CRD management
  # Traefik installs and manages Gateway API CRDs (standard channel)
  syncOptions:
    - CreateNamespace=true
    - ServerSideApply=true
    - PruneLast=true
