---
# Configuration LoxiLB - Dev
environment: dev
appName: loxilb

loxilb:
  # Image versions (tracked by Renovate)
  loxilbImage: "ghcr.io/loxilb-io/loxilb"
  loxilbTag: "v0.9.8"
  kubeLoxilbImage: "ghcr.io/loxilb-io/kube-loxilb"
  kubeLoxilbTag: "v0.9.8.5"

  # LB Configuration
  # 0 = DNAT (default), 1 = one-arm, 2 = fullNAT
  # With Multus (macvlan), use onearm (1) with these service annotations:
  #   loxilb.io/lbmode: "onearm"
  #   loxilb.io/usepodnetwork: "yes"
  # usepodnetwork routes traffic via eth0 (Cilium) to pod IPs directly,
  # avoiding the macvlan isolation issue with the host's eth1 interface.
  setLBMode: 1

  # Deployment mode: "internal" (in-cluster DaemonSet) or "external" (standalone Docker container)
  # - internal: loxilb runs as DaemonSet inside the cluster (requires Multus with Cilium)
  # - external: loxilb runs outside the cluster, kube-loxilb connects via loxiURL
  mode: "external"

  # External mode: list of external loxilb Docker container API URLs
  # kube-loxilb connects to all URLs via --loxiURL=url1,url2,...
  # The loxilb container runs with --net=host inside dedicated Vagrant VMs.
  # IPs: $network_prefix.40 (1st), .41 (2nd), .42 (3rd), ...
  # The Vagrantfile derives the VM count automatically from this list.
  loxiURL:
    - "http://192.168.121.40:11111"
    - "http://192.168.121.41:11111"
    - "http://192.168.121.42:11111"

  # BGP peering: Cilium advertise PodCIDR routes vers loxilb externe
  bgp:
    enabled: true
    localASN: 65002
    extBGPPeers: "192.168.121.50:64512"  # master_ip:cilium_asn

syncPolicy:
  automated:
    enabled: true
    prune: true
    selfHeal: true
