---
# Configuration NeuVector - Dev
environment: dev
appName: neuvector

neuvector:
  # Helm chart versions
  version: "2.8.10"        # Core chart version
  monitorVersion: "2.8.10" # Monitor chart version (Prometheus exporter)

  # Controller (actual: 37m/1191Mi, 2 replicas for Consul quorum)
  controller:
    replicas: 2
    resources:
      requests:
        cpu: "30m"
        memory: "1200Mi"
      limits:
        cpu: "2000m"
        memory: "3Gi"

  # Enforcer (actual: 501m/554Mi - DaemonSet, runs on all nodes)
  enforcer:
    resources:
      requests:
        cpu: "200m"
        memory: "550Mi"
      limits:
        cpu: "1500m"
        memory: "2Gi"

  # Manager (actual: 3m/518Mi - Web UI)
  manager:
    resources:
      requests:
        cpu: "10m"
        memory: "650Mi"
      limits:
        cpu: "500m"
        memory: "1Gi"

  # Scanner (actual idle: 1m/74Mi, loads CVE DB during scans)
  scanner:
    replicas: 1
    resources:
      requests:
        cpu: "5m"
        memory: "128Mi"
      limits:
        cpu: "1000m"
        memory: "2Gi"

  # Prometheus exporter settings
  exporter:
    # WARNING: enforcerStats impacts performance - enable only if needed
    enforcerStats:
      enabled: true
    # Resources (actual: ~1m CPU, ~25Mi mem)
    resources:
      requests:
        cpu: "5m"
        memory: "32Mi"
      limits:
        cpu: "50m"
        memory: "64Mi"

  # OIDC Configuration (Keycloak) - Native NeuVector OIDC
  # Secrets (clientId, clientSecret) managed via SOPS in secrets/dev/secret.yaml
  oidc:
    enabled: true

syncPolicy:
  automated:
    enabled: true
    prune: true
    selfHeal: true
