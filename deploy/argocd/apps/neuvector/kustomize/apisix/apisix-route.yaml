---
# =============================================================================
# ApisixRoute - NeuVector Manager
# =============================================================================
# Routes HTTPS traffic to NeuVector Manager Web UI (HTTPS backend on port 8443)
#
# HTTPS Backend: Uses custom Service (neuvector-manager-https) with appProtocol: https.
# APISIX Ingress Controller automatically detects HTTPS backend from appProtocol field.
# This is needed because NeuVector Helm chart doesn't set appProtocol on its Service.
# =============================================================================
apiVersion: apisix.apache.org/v2
kind: ApisixRoute
metadata:
  name: neuvector-manager
  namespace: neuvector
spec:
  ingressClassName: apisix
  http:
    - name: manager
      match:
        hosts:
          - neuvector.PLACEHOLDER_DOMAIN  # Patched via Kustomize from common.domain
        paths:
          - /*
      backends:
        - serviceName: neuvector-manager-https
          servicePort: 8443
