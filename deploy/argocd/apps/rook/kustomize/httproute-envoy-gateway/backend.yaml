---
# =============================================================================
# Backend - Ceph Dashboard HTTPS (Envoy Gateway)
# =============================================================================
# Defines the backend for Ceph Dashboard with TLS 1.3 configuration.
# Ceph Dashboard only accepts TLS 1.3 connections, so we must specify
# minVersion and maxVersion to force TLS 1.3.
#
# Uses caCertificateRefs to validate the Ceph Dashboard certificate against
# the cluster CA (synced via ExternalSecret from cert-manager).
# =============================================================================
apiVersion: gateway.envoyproxy.io/v1alpha1
kind: Backend
metadata:
  name: ceph-dashboard-backend
  namespace: rook-ceph
spec:
  endpoints:
    - fqdn:
        hostname: rook-ceph-mgr-dashboard.rook-ceph.svc.cluster.local
        port: 8443
  tls:
    caCertificateRefs:
      - group: ""
        kind: Secret
        name: ceph-dashboard-backend-ca
    minVersion: "1.3"
    maxVersion: "1.3"
    sni: rook-ceph-mgr-dashboard.rook-ceph.svc.cluster.local
