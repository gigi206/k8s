---
# Configuration External-DNS - Prod
environment: prod
appName: external-dns

# Override domain for prod environment if needed
# common:
#   domain: "example.local"

externalDns:
  version: "1.20.0"
  # Provider: cloudflare, aws, google, coredns, etc.
  # Use "coredns" for local DNS with etcd backend
  provider: "coredns"

  # TXT owner ID
  txtOwnerId: "external-dns-prod"

  # Sources to watch (service, ingress, crd, istio-gateway, etc.)
  sources:
    - "service"
    - "ingress"
    - "crd"

  # Sync interval
  interval: "15s"

  # Policy: sync or upsert-only
  policy: "sync"

  # RBAC
  rbac:
    create: true

  # CRD support
  crd:
    create: true

  # CoreDNS configuration (only when provider=coredns)
  coredns:
    version: "1.45.2"
    enabled: false
    replicas: 2
    serviceType: "LoadBalancer"
    # Optional: loadBalancerIP for MetalLB
    # loadBalancerIP: "192.168.121.100"

  # etcd configuration (only when provider=coredns)
  etcd:
    version: "0.5.3"
    enabled: false
    replicas: 3
    # mTLS configuration (authentication via client certificates)
    tls:
      enabled: true
      serverSecret: "external-dns-etcd-server-tls"
      clientSecret: "external-dns-etcd-client-tls"
      peerSecret: "external-dns-etcd-peer-tls"
      caSecret: "external-dns-etcd-ca"

syncPolicy:
  automated:
    enabled: false  # Prod: manual sync
    prune: true
    selfHeal: true
