---
# Configuration External-DNS - Dev
environment: dev
appName: external-dns

externalDns:
  version: "1.20.0"
  # Provider: cloudflare, aws, google, coredns, etc.
  # Use "coredns" for local DNS with etcd backend
  provider: "coredns"

  # TXT owner ID
  txtOwnerId: "external-dns-dev"

  # Sources to watch (service, ingress, crd, gateway-httproute, istio-gateway, etc.)
  # Note: istio-gateway requires Istio Gateway CRD to be installed
  sources:
    - "service"
    - "ingress"
    - "crd"
    - "gateway-httproute"  # Gateway API HTTPRoute support

  # Sync interval
  interval: "30s"

  # Policy: sync or upsert-only
  policy: "sync"

  # RBAC
  rbac:
    create: true

  # CRD support
  crd:
    create: true

  # CoreDNS configuration (only when provider=coredns)
  coredns:
    version: "1.45.0"
    enabled: true
    replicas: 1
    serviceType: "LoadBalancer"
    # loadBalancerIP is now centralized in config.yaml (features.externalDns.loadBalancerIP)

  # etcd configuration (only when provider=coredns)
  etcd:
    version: "0.5.0"  # CloudPirates OCI (was groundhog2k 1.1.4)
    enabled: true
    replicas: 1
    # mTLS configuration (authentication via client certificates)
    tls:
      enabled: true
      serverSecret: "external-dns-etcd-server-tls"
      clientSecret: "external-dns-etcd-client-tls"
      peerSecret: "external-dns-etcd-peer-tls"
      caSecret: "external-dns-etcd-ca"

syncPolicy:
  automated:
    enabled: true
    prune: true
    selfHeal: true
